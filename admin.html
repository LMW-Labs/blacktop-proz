<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <title>BlacktopProz | Admin Dashboard</title>
    <link rel="stylesheet" href="admin.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&family=Impact&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-box">
            <div class="login-logo">
                <img src="assets/blacktopproz_logo.svg" alt="BlacktopProz Logo">
            </div>
            <form id="loginForm">
                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" placeholder="Enter admin password" required>
                </div>
                <button type="submit" class="btn btn-primary btn-block">Login</button>
                <p id="loginError" class="error-message"></p>
            </form>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminDashboard" class="admin-dashboard" style="display: none;">
        <!-- Mobile Header -->
        <header class="mobile-header">
            <button class="menu-toggle" id="menuToggle">
                <span></span><span></span><span></span>
            </button>
            <img src="assets/blacktopproz_logo.svg" alt="BlacktopProz" class="mobile-logo">
            <div class="header-spacer"></div>
        </header>

        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <img src="assets/blacktopproz_logo.svg" alt="BlacktopProz Logo" class="sidebar-logo">
            </div>
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-section="dashboard">
                    <span class="icon">üìä</span> Dashboard
                </a>
                <a href="#" class="nav-item" data-section="quickQuote">
                    <span class="icon">‚ö°</span> Quick Quote
                </a>
                <a href="#" class="nav-item" data-section="quotes">
                    <span class="icon">üìù</span> All Quotes
                </a>
                <a href="#" class="nav-item" data-section="invoices">
                    <span class="icon">üìÑ</span> Invoices
                </a>
                <a href="#" class="nav-item" data-section="pricing">
                    <span class="icon">üí∞</span> Pricing Guide
                </a>
                <a href="#" class="nav-item" data-section="customers">
                    <span class="icon">üë•</span> Customers
                </a>
                <a href="#" class="nav-item" data-section="settings">
                    <span class="icon">‚öôÔ∏è</span> Settings
                </a>
            </nav>
            <div class="sidebar-footer">
                <a href="index.html" class="nav-item">
                    <span class="icon">üåê</span> View Website
                </a>
                <a href="#" class="nav-item" id="logoutBtn">
                    <span class="icon">üö™</span> Logout
                </a>
            </div>
        </aside>

        <!-- Overlay for mobile menu -->
        <div class="sidebar-overlay" id="sidebarOverlay"></div>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Dashboard Section -->
            <section id="dashboardSection" class="content-section active">
                <div class="section-header">
                    <h1>Dashboard</h1>
                    <p>Welcome back, Christopher</p>
                </div>

                <!-- Quick Actions - Large Touch Targets -->
                <div class="quick-actions">
                    <button class="quick-action-btn" onclick="goToSection('quickQuote')">
                        <span class="qa-icon">‚ö°</span>
                        <span class="qa-text">New Quote</span>
                    </button>
                    <button class="quick-action-btn" onclick="goToSection('invoices'); setTimeout(() => document.getElementById('newInvoiceBtn').click(), 100)">
                        <span class="qa-icon">üìÑ</span>
                        <span class="qa-text">New Invoice</span>
                    </button>
                    <button class="quick-action-btn" onclick="goToSection('pricing')">
                        <span class="qa-icon">üí∞</span>
                        <span class="qa-text">Pricing</span>
                    </button>
                </div>

                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üìù</div>
                        <div class="stat-info">
                            <span class="stat-number" id="pendingQuotes">0</span>
                            <span class="stat-label">Pending Quotes</span>
                        </div>
                    </div>
                    <div class="stat-card warning">
                        <div class="stat-icon">‚ö†Ô∏è</div>
                        <div class="stat-info">
                            <span class="stat-number" id="unpaidInvoices">0</span>
                            <span class="stat-label">Unpaid Invoices</span>
                        </div>
                    </div>
                    <div class="stat-card success">
                        <div class="stat-icon">üíµ</div>
                        <div class="stat-info">
                            <span class="stat-number" id="monthlyRevenue">$0</span>
                            <span class="stat-label">This Month</span>
                        </div>
                    </div>
                    <div class="stat-card danger">
                        <div class="stat-icon">üî¥</div>
                        <div class="stat-info">
                            <span class="stat-number" id="overdueInvoices">0</span>
                            <span class="stat-label">Overdue (30+)</span>
                        </div>
                    </div>
                </div>

                <!-- Unpaid Invoices Aging -->
                <div class="dashboard-card">
                    <h2>Invoice Aging</h2>
                    <div class="aging-grid">
                        <div class="aging-item current">
                            <span class="aging-label">Current</span>
                            <span class="aging-amount" id="agingCurrent">$0</span>
                        </div>
                        <div class="aging-item days30">
                            <span class="aging-label">30+ Days</span>
                            <span class="aging-amount" id="aging30">$0</span>
                        </div>
                        <div class="aging-item days60">
                            <span class="aging-label">60+ Days</span>
                            <span class="aging-amount" id="aging60">$0</span>
                        </div>
                        <div class="aging-item days90">
                            <span class="aging-label">90+ Days</span>
                            <span class="aging-amount" id="aging90">$0</span>
                        </div>
                    </div>
                </div>

                <!-- Recent Activity -->
                <div class="dashboard-card">
                    <h2>Recent Activity</h2>
                    <div id="recentActivity" class="activity-list">
                        <p class="no-data">No recent activity</p>
                    </div>
                </div>
            </section>

            <!-- Quick Quote Section - Mobile Optimized -->
            <section id="quickQuoteSection" class="content-section">
                <div class="section-header">
                    <h1>‚ö° Quick Quote</h1>
                    <p>Build a quote in seconds</p>
                </div>

                <form id="quickQuoteForm" class="mobile-form">
                    <!-- Customer Info -->
                    <div class="form-card">
                        <h3>üë§ Customer Info</h3>
                        <div class="form-group">
                            <label for="qqCustomerName">Name *</label>
                            <input type="text" id="qqCustomerName" required autocomplete="name">
                        </div>
                        <div class="form-group">
                            <label for="qqCustomerPhone">Phone *</label>
                            <input type="tel" id="qqCustomerPhone" required autocomplete="tel">
                        </div>
                        <div class="form-group">
                            <label for="qqCustomerEmail">Email</label>
                            <input type="email" id="qqCustomerEmail" autocomplete="email">
                        </div>
                        <div class="form-group">
                            <label for="qqCustomerType">Customer Type</label>
                            <select id="qqCustomerType">
                                <option value="residential">üè† Residential</option>
                                <option value="commercial">üè¢ Commercial</option>
                            </select>
                        </div>
                    </div>

                    <!-- Job Site -->
                    <div class="form-card">
                        <h3>üìç Job Site</h3>
                        <div class="form-group">
                            <label for="qqJobAddress">Address *</label>
                            <input type="text" id="qqJobAddress" required>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="qqJobCity">City *</label>
                                <input type="text" id="qqJobCity" required>
                            </div>
                            <div class="form-group">
                                <label for="qqJobZip">ZIP</label>
                                <input type="text" id="qqJobZip">
                            </div>
                        </div>
                    </div>

                    <!-- Service Selection - Checkbox Style -->
                    <div class="form-card">
                        <h3>üõ†Ô∏è Select Services</h3>
                        <p class="helper-text">Check services needed, prices auto-calculate</p>

                        <div class="service-selector" id="serviceSelector">
                            <!-- Services will be populated by JS -->
                        </div>
                    </div>

                    <!-- Quote Summary -->
                    <div class="form-card summary-card">
                        <h3>üí∞ Quote Summary</h3>
                        <div id="selectedServices" class="selected-services">
                            <p class="no-data">No services selected</p>
                        </div>
                        <div class="quote-totals">
                            <div class="total-row">
                                <span>Subtotal:</span>
                                <span id="qqSubtotal">$0.00</span>
                            </div>
                            <div class="total-row">
                                <span>Tax (7%):</span>
                                <span id="qqTax">$0.00</span>
                            </div>
                            <div class="total-row grand-total">
                                <span>Total:</span>
                                <span id="qqTotal">$0.00</span>
                            </div>
                        </div>

                        <!-- Warranty Info -->
                        <div id="warrantyInfo" class="warranty-info" style="display: none;">
                            <h4>üìã Warranty Coverage</h4>
                            <ul id="warrantyList"></ul>
                        </div>
                    </div>

                    <!-- Notes -->
                    <div class="form-card">
                        <h3>üìù Notes</h3>
                        <div class="form-group">
                            <textarea id="qqNotes" rows="3" placeholder="Special instructions, conditions, etc."></textarea>
                        </div>
                    </div>

                    <!-- Actions -->
                    <div class="form-actions sticky-actions">
                        <button type="button" class="btn btn-secondary" onclick="saveQuoteDraft()">Save Draft</button>
                        <button type="button" class="btn btn-primary" onclick="previewQuote()">Preview & Send</button>
                    </div>
                </form>
            </section>

            <!-- All Quotes Section -->
            <section id="quotesSection" class="content-section">
                <div class="section-header">
                    <h1>Quotes</h1>
                    <button class="btn btn-primary" onclick="goToSection('quickQuote')">+ New Quote</button>
                </div>

                <!-- Filter Tabs -->
                <div class="filter-tabs">
                    <button class="filter-tab active" data-filter="all">All</button>
                    <button class="filter-tab" data-filter="draft">Drafts</button>
                    <button class="filter-tab" data-filter="sent">Sent</button>
                    <button class="filter-tab" data-filter="accepted">Accepted</button>
                    <button class="filter-tab" data-filter="declined">Declined</button>
                </div>

                <!-- Quotes List - Mobile Cards -->
                <div id="quotesListCards" class="cards-list">
                    <p class="no-data">No quotes yet. Create your first quote!</p>
                </div>
            </section>

            <!-- Invoices Section -->
            <section id="invoicesSection" class="content-section">
                <div class="section-header">
                    <h1>Invoices</h1>
                    <button class="btn btn-primary" id="newInvoiceBtn">+ New Invoice</button>
                </div>

                <!-- Filter Tabs -->
                <div class="filter-tabs">
                    <button class="filter-tab active" data-filter="all">All</button>
                    <button class="filter-tab" data-filter="unpaid">Unpaid</button>
                    <button class="filter-tab" data-filter="partial">Partial</button>
                    <button class="filter-tab" data-filter="paid">Paid</button>
                    <button class="filter-tab" data-filter="overdue">Overdue</button>
                </div>

                <!-- Invoice Form Modal -->
                <div id="invoiceFormContainer" class="modal-container" style="display: none;">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h2>Create Invoice</h2>
                            <button class="btn-close" onclick="closeInvoiceForm()">&times;</button>
                        </div>
                        <form id="invoiceForm" class="mobile-form">
                            <div class="form-group">
                                <label for="invoiceFromQuote">Create from Quote</label>
                                <select id="invoiceFromQuote">
                                    <option value="">-- Start Fresh --</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="invCustomerName">Customer Name *</label>
                                <input type="text" id="invCustomerName" required>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="invCustomerPhone">Phone *</label>
                                    <input type="tel" id="invCustomerPhone" required>
                                </div>
                                <div class="form-group">
                                    <label for="invCustomerEmail">Email</label>
                                    <input type="email" id="invCustomerEmail">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="invJobAddress">Job Address *</label>
                                <input type="text" id="invJobAddress" required>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="invJobCity">City *</label>
                                    <input type="text" id="invJobCity" required>
                                </div>
                                <div class="form-group">
                                    <label for="invJobZip">ZIP</label>
                                    <input type="text" id="invJobZip">
                                </div>
                            </div>

                            <h3>Line Items</h3>
                            <div id="invLineItems" class="line-items-mobile"></div>
                            <button type="button" class="btn btn-secondary btn-sm" onclick="addInvoiceLineItem()">+ Add Item</button>

                            <div class="quote-totals">
                                <div class="total-row">
                                    <span>Subtotal:</span>
                                    <span id="invSubtotal">$0.00</span>
                                </div>
                                <div class="total-row">
                                    <span>Tax (7%):</span>
                                    <span id="invTax">$0.00</span>
                                </div>
                                <div class="total-row grand-total">
                                    <span>Total:</span>
                                    <span id="invTotal">$0.00</span>
                                </div>
                            </div>

                            <div class="form-row">
                                <div class="form-group">
                                    <label for="invPaymentTerms">Payment Terms</label>
                                    <select id="invPaymentTerms">
                                        <option value="due_receipt">Due on Receipt</option>
                                        <option value="net_15">Net 15</option>
                                        <option value="net_30" selected>Net 30</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="invDeposit">Deposit Required</label>
                                    <select id="invDeposit">
                                        <option value="0">No Deposit</option>
                                        <option value="25">25%</option>
                                        <option value="50" selected>50%</option>
                                    </select>
                                </div>
                            </div>

                            <div class="form-group">
                                <label for="invNotes">Notes</label>
                                <textarea id="invNotes" rows="2"></textarea>
                            </div>

                            <div class="form-actions">
                                <button type="button" class="btn btn-secondary" onclick="closeInvoiceForm()">Cancel</button>
                                <button type="submit" class="btn btn-primary">Create Invoice</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Invoices List - Mobile Cards -->
                <div id="invoicesListCards" class="cards-list">
                    <p class="no-data">No invoices yet.</p>
                </div>
            </section>

            <!-- Pricing Guide Section -->
            <section id="pricingSection" class="content-section">
                <div class="section-header">
                    <h1>üí∞ Pricing Guide</h1>
                    <button class="btn btn-secondary btn-sm" id="editPricingBtn">Edit Prices</button>
                </div>

                <div class="pricing-info-card">
                    <p><strong>Strategy:</strong> 10-20% below market rate to win jobs</p>
                </div>

                <!-- Pricing Table -->
                <div class="pricing-table-container">
                    <table class="pricing-table" id="pricingTable">
                        <thead>
                            <tr>
                                <th>Service</th>
                                <th>Our Price</th>
                                <th>Market</th>
                                <th>Unit</th>
                            </tr>
                        </thead>
                        <tbody id="pricingTableBody">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>

                <!-- Quick Reference -->
                <div class="form-card">
                    <h3>üìê Typical Job Estimates</h3>
                    <div class="quick-ref-grid" id="quickRefGrid">
                        <!-- Populated by JS -->
                    </div>
                </div>

                <!-- Minimums -->
                <div class="form-card">
                    <h3>‚ö†Ô∏è Minimum Service Fees</h3>
                    <div class="minimums-grid">
                        <div class="minimum-item">
                            <span class="min-label">üè† Residential</span>
                            <span class="min-value">$150</span>
                        </div>
                        <div class="minimum-item">
                            <span class="min-label">üè¢ Commercial</span>
                            <span class="min-value">$250</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Customers Section -->
            <section id="customersSection" class="content-section">
                <div class="section-header">
                    <h1>Customers</h1>
                </div>

                <!-- Search -->
                <div class="search-bar">
                    <input type="text" id="customerSearch" placeholder="Search by name, phone, or address...">
                </div>

                <!-- Filter Tabs -->
                <div class="filter-tabs">
                    <button class="filter-tab active" data-filter="all">All</button>
                    <button class="filter-tab" data-filter="residential">Residential</button>
                    <button class="filter-tab" data-filter="commercial">Commercial</button>
                </div>

                <!-- Customers List -->
                <div id="customersListCards" class="cards-list">
                    <p class="no-data">No customers yet.</p>
                </div>
            </section>

            <!-- Settings Section -->
            <section id="settingsSection" class="content-section">
                <div class="section-header">
                    <h1>Settings</h1>
                </div>

                <div class="form-card">
                    <h3>üè¢ Business Info</h3>
                    <form id="settingsForm">
                        <div class="form-group">
                            <label for="businessName">Business Name</label>
                            <input type="text" id="businessName" value="BlacktopProz">
                        </div>
                        <div class="form-group">
                            <label for="businessPhone">Phone</label>
                            <input type="tel" id="businessPhone" value="(601) 813-2533">
                        </div>
                        <div class="form-group">
                            <label for="businessEmail">Email</label>
                            <input type="email" id="businessEmail">
                        </div>
                        <div class="form-group">
                            <label for="businessAddress">Address</label>
                            <textarea id="businessAddress" rows="2">Jackson, MS</textarea>
                        </div>
                        <button type="submit" class="btn btn-primary">Save Settings</button>
                    </form>
                </div>

                <div class="form-card">
                    <h3>üí≥ Payment Info (shown on invoices)</h3>
                    <form id="paymentInfoForm">
                        <div class="form-group">
                            <label for="venmoHandle">Venmo</label>
                            <input type="text" id="venmoHandle" placeholder="@username">
                        </div>
                        <div class="form-group">
                            <label for="zelleInfo">Zelle (Phone/Email)</label>
                            <input type="text" id="zelleInfo" placeholder="Phone or email">
                        </div>
                        <div class="form-group">
                            <label for="checkPayable">Checks Payable To</label>
                            <input type="text" id="checkPayable" value="BlacktopProz">
                        </div>
                        <button type="submit" class="btn btn-primary">Save Payment Info</button>
                    </form>
                </div>

                <div class="form-card">
                    <h3>üîê Change Password</h3>
                    <form id="passwordForm">
                        <div class="form-group">
                            <label for="currentPassword">Current Password</label>
                            <input type="password" id="currentPassword" required>
                        </div>
                        <div class="form-group">
                            <label for="newPassword">New Password</label>
                            <input type="password" id="newPassword" required>
                        </div>
                        <div class="form-group">
                            <label for="confirmPassword">Confirm Password</label>
                            <input type="password" id="confirmPassword" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Update Password</button>
                    </form>
                </div>
            </section>
        </main>
    </div>

    <!-- Quote Preview Modal -->
    <div id="quotePreviewModal" class="modal-container" style="display: none;">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Quote Preview</h2>
                <button class="btn-close" onclick="closeQuotePreview()">&times;</button>
            </div>
            <div id="quotePreviewContent" class="preview-content">
                <!-- Quote preview will be rendered here -->
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeQuotePreview()">Edit</button>
                <button class="btn btn-primary" onclick="saveAndEmailQuote()">üìß Save & Email</button>
                <button class="btn btn-success" onclick="saveAndPrintQuote()">üñ®Ô∏è Save & Print</button>
            </div>
        </div>
    </div>

    <!-- Invoice Preview Modal -->
    <div id="invoicePreviewModal" class="modal-container" style="display: none;">
        <div class="modal-content modal-large">
            <div class="modal-header">
                <h2>Invoice Preview</h2>
                <button class="btn-close" onclick="closeInvoicePreview()">&times;</button>
            </div>
            <div id="invoicePreviewContent" class="preview-content">
                <!-- Invoice preview will be rendered here -->
            </div>
            <div class="modal-actions">
                <button class="btn btn-secondary" onclick="closeInvoicePreview()">Close</button>
                <button class="btn btn-primary" onclick="emailInvoice()">üìß Email</button>
                <button class="btn btn-success" onclick="printInvoice()">üñ®Ô∏è Print</button>
            </div>
        </div>
    </div>

    <!-- Print Templates -->
    <div id="printContainer" class="print-container"></div>

    <!-- Toast Notifications -->
    <div id="toastContainer" class="toast-container"></div>

    <script src="admin.js"></script>
</body>
</html>
